　　今天主要是写了单元测试，主要产生的问题有以下几点：　　
1. 单元测试和TC的关系。今天中午的时候已经讲过了。  
1. 单元测试里面如何去mock一个被测试类中New出来的对象。  
>上午的时候查了查，都是用Powermock去解决问题的。但是在我自己这里却怎么也实现不了。后来还是快中午薄振成回来的时候问的他。被告知直接静态去mock然后set进去就行了，其实这样好像要去修改源代码，在service里面对成员进行get、set。总而言之，上午遇到的问题解决了。  

3. 单元测试里面如何去mock一个new Date()这种的。  
> 查了查网上的方法，又都是用powerMock去解决Mock的问题，后来找到了，但是导过包后，环境好像不能去运行，连正常的mockito都不能去运行。后来想了想逻辑，我可以不用去mock这个时间，取而代之用任意值去替代参数整个对象，连数据拼装都省下了。  

4. 上面说到参数任意值，正常的是给了各种类型，anyString（），anyInt（）等，但是只是有基本的类型，对于自定义的对象却没有，然后问题来了，解决any自定义类型参数。  
> `Mockito.argThat(new IsPage())`这个来模拟自定义类型，其中`new IsPage()`是要自己去定义的。  
```
class IsPage extends ArgumentMatcher<WanwdManhuaPage>{
		@Override
		public boolean matches(Object argument) {
			if (argument.getClass()==WanwdManhuaPage.class) {
				return true;
			}
			return false;
		}
	}
```  
继承`ArgumentMatcher`类，重写matches方法,判定参数的类型是不是自己的自定义类型。  

4. 问题还是有的，今晚我遇到了一个问题，我做的点赞接口，正常来说是只能点赞一次，但是今天晚上调的时候，前端一不小心同时发送了两次，（我是在点赞的时候有验证是否点赞过的），回到我这里我一看数据库里面是有两条一模一样的数据，时间戳都一样。我想问一下这是表没有加锁的原因么？还是其他的一些原因（说实话我不知道表有没有加锁，或许点赞记录表没有必要加锁吧，因为点赞记录多一条少一条对钱来说没有什么太大关系）。
6. 还是单元测试的问题，这个今天晚上的时候已经被解决了。问题就是那个new的对象，在上午的时候问题已经解决了。但在下午的时候又暴露出我代码写的有问题，上午的时候那个new出来的对象只在自己的方法里被使用，没有其他的Bll调用。但是下下午的测试里，需要和其他的一起用。这样问题就暴露出来的，getset出来的new agent，是impl里的方法，spring注入的Bll是从接口那里注入的，具体的问题我已经说不清楚了，反正是两种不能混在一起，后来晚上的时候又问了薄振成，结果最后是调出来了，解决方案也给我了。两点：  
  1. 在serviceimpl里getset，config里面直接去new接口，new出来的agent直接去Mock。
  2. 在service上不去new agent ，通过spring配置文件注入Bean，然后去autowire，在config里面去mock agent。   
第一种我感觉我好像自己去试的时候试过，但是貌似没通。。。。(- ~ -)  
7. 说起接口，我问一句，公司里面的都不写接口吗？我看之前的代码写接口的真的很少。
